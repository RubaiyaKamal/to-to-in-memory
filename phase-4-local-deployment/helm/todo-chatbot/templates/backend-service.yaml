{{- /*
Kubernetes Service for Todo Chatbot Backend
Task 3.2: Helm Templates
Reference: specs/003-local-k8s-deployment/tasks.md

This template creates a ClusterIP service for internal access to the FastAPI backend.
Service DNS: todo-chatbot-backend.todo-chatbot.svc.cluster.local
*/ -}}
{{- if .Values.backend.enabled }}
apiVersion: v1
kind: Service
metadata:
  name: todo-chatbot-backend
  namespace: {{ .Values.namespace.name }}
  labels:
    {{- include "todo-chatbot.labels" . | nindent 4 }}
    component: backend
  annotations:
    description: "Internal ClusterIP service for FastAPI backend"
spec:
  # ClusterIP: Internal service only, not exposed outside cluster
  type: {{ .Values.backend.service.type }}

  # Selector must match backend deployment pod labels
  selector:
    app: todo-chatbot-backend

  # Port configuration
  ports:
  - name: http
    port: {{ .Values.backend.service.port }}
    targetPort: {{ .Values.backend.service.targetPort }}
    protocol: TCP

  # Session affinity: None for stateless API
  sessionAffinity: None
{{- end }}
